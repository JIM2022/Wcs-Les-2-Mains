{% extends '@Core/layout.html.twig' %}

{% block body %}
    <div id="events">
        <div class="products_navigation">
            {% for activite in activities %}
                <div class="nav_word_block">
                    <a href="#{{ activite.id }}" class="nav_word">{{ activite.titre }}</a>
                </div>
            {% endfor %}
        </div>
        <div class="parallax-container">
            <div class="section header">
                <h2 class="header center teal-text text-lighten-2">Nos stages</h2>
            </div>
            <div class="parallax">
                <img src="{{ asset('bundles/core/img/background/pic1.jpg') }}">
            </div>
        </div>
        <div class="container">
               <div class="row">
                   {% if is_granted('ROLE_ADMIN') %}
                       <!-- Modal Trigger -->
                       <a class=" col s6 offset-s3 waves-effect waves-light btn add_stage_btn" href="#addevent">Ajouter un stage</a>
                       <!-- Modal Structure -->
                       <div id="addevent" class="modal">
                           <div class="modal-content">
                               <h4>Ajouter un stage</h4>
                               {{ form_start(form) }}

                               <div class="input-field form_add">
                                   {{ form_label(form.title) }}
                                   {{ form_widget(form.title) }}
                                   {{ form_errors(form.title) }}
                               </div>

                               <div class="input-field form_add">
                                   {{ form_label(form.description) }}
                                   {{ form_widget(form.description) }}
                                   {{ form_errors(form.description) }}
                               </div>

                               <div class="form_add">
                                   {{ form_label(form.dateStart) }}
                                   {{ form_widget(form.dateStart) }}
                                   {{ form_errors(form.dateStart) }}
                               </div>

                               <div class="form_add">
                                   {{ form_label(form.dateEnd) }}
                                   {{ form_widget(form.dateEnd) }}
                                   {{ form_errors(form.dateEnd) }}
                               </div>

                               <div class="input-field form_add">
                                   {{ form_label(form.location) }}
                                   {{ form_widget(form.location) }}
                                   {{ form_errors(form.location) }}
                               </div>

                               <div class="form_add">
                                   {{ form_label(form.price) }}
                                   {{ form_widget(form.price) }}
                                   {{ form_errors(form.price) }}
                               </div>

                               <div class="input-field form_add">
                                   {{ form_label(form.available_places) }}
                                   {{ form_widget(form.available_places) }}
                                   {{ form_errors(form.available_places) }}
                               </div>

                               <div class="form_add">
                                   {{ form_label(form.activite) }}
                                   {{ form_widget(form.activite) }}
                                   {{ form_errors(form.activite) }}
                               </div>
                               <div class="input-field form_add">
		                           {{ form_widget(form.picture.file, {'attr': {'required': 'true' }}) }}
		                           {{ form_errors(form.picture.file) }}
                               </div>
                               <div class="row">
		                           {{ form_widget(form.submit, {'attr': {'class': 'btn btn-primary'}}) }}
                               </div>
                               {{ form_end((form))}}
                           </div>
                       </div>
                   {% endif %}
               </div>
            
                <div class="row">
                {% for activite in activities  %}
                <h2 id="{{ activite.id }}" class="text_perso_events h2_events">{{ activite.titre }}</h2>
                {% for event in activite.event %}
                {% set i = i + 1 %}
                <div class="col m6">
                    <div class="card">
                        <div class="card-image waves-effect waves-block waves-light">
                            <div class="card_picture" style="background-image: url('{{ asset('uploads/images/' ~ event.picture.src ) }}'); background-size:cover; background-position:center">
                                <div class="block_text_card_picture activator btn waves-effect waves-light">
                                    <span class="text_card_picture big_text_card_picture activator">Cliquez</span>
                                    <span class="text_card_picture medium_text_card_picture activator">Pour plus d'infos</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <span class="card-title activator grey-text text-darken-4">{{ event.title }} <i class="material-icons right">reply</i></span>
                            <button class="btn waves-effect waves-light" type="submit" name="action">video
                            </button>
                            {# TODO A mettre en place avec un Form #}
                           {# <button class="btn waves-effect waves-light" type="submit" name="action">Je participe
                                <i class="medium material-icons right">done</i>
                            </button>
#}
                        </div>
                        <div class="card-reveal">
                            <div class="card-reveal">
                                <span class="card-title grey-text text-darken-4"><i class="material-icons right">close</i></span>
                                <h4 class="text_perso_events">Description</h4>
                                <p class="p_justify">{{ event.description|nl2br }}</p>
                                <h4 class="text_perso_events">Informations :</h4>
                                <p><b class="text_perso_events">Date :</b> {{ event.dateStart|date("d/m/Y H:i") }} à {{ event.dateEnd|date("d/m/Y H:i")  }}</p>
                                <p><b class="text_perso_events">Lieu :</b> {{ event.location }}</p>
                                <p><b class="text_perso_events">Prix :</b> {{ event.price }}€</p>
                                <p><b class="text_perso_events">Places disponibles :</b> {{ event.availablePlaces }}</p>
                                <a class="waves-effect waves-light btn add_stage_btn" href="{{ 'contact' }}">Besoin de plus d'info ?</a>
                            </div>
                        </div>
                    </div>
                    {% if is_granted('ROLE_ADMIN') %}
                        <!-- /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
                        <!-- Modal Trigger -->
                        <a class="waves-effect waves-light center-align btn" href="#modal{{ event.id }}">Modifier</a>

                        <!-- Modal Structure -->
                        <div id="modal{{ event.id }}" class="modal">
                            {{ render(controller('CommerceBundle:Event:editEvent', { 'id': event.id})) }}
                        </div>
                        <!-- /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
                        <a class="waves-effect waves-light center-align btn" href=" {{ path('event_delete', {'id': event.id}) }}">Effacer</a>
                    {% endif %}


                </div>

                {% endfor %}
            </div>
        </div>
        <div class="parallax-container event_parallax">
            <div class="parallax">
                <img src="{{ asset('bundles/core/img/background/pic2.jpg') }}" alt="Unsplashed background img 2">
            </div>
        </div>
        <div class="container container_custom">
            <div class="row row_cards_events">
                
                
                {% endfor %}

            </div>
        </div>
        {% include '@Core/pages/footer.html.twig' %}

    </div>
{% endblock %}
