{% extends '@Core/layout.html.twig' %}

{% block body %}

<div id="blog">
    <div class="parallax-container">
        <div class="row">
            <h1 class="col s12 center title">Fil d'actu</h1>
            {% if is_granted('ROLE_ADMIN') %}
            <!-- Modal Trigger -->
            <a class="col s2 offset-s5 waves-effect waves-light btn" href="#addArticle">Ajouter une Actu</a>

            <!-- Modal Structure -->
            <div id="addArticle" class="modal">
                <div class="modal-content">
                    {{ form_start(form) }}

                    <div class="form_add">
                        {{ form_label(form.titre) }}
                        {{ form_widget(form.titre) }}
                        {{ form_errors(form.titre) }}
                    </div>
                    <div class="form_add">
                        {{ form_label(form.contenu) }}
                        {{ form_widget(form.contenu) }}
                        {{ form_errors(form.contenu) }}
                    </div>
                    <div class="form_add">
                        {{ form_label(form.date) }}
                        {{ form_widget(form.date) }}
                        {{ form_errors(form.date) }}
                    </div>
                    <div class="form_add">
                        {{ form_widget(form.submit, { 'label': 'Valider' }) }}
                    </div>

                    {{ form_end(form) }}
                </div>
                <div class="modal-footer">
                    <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
                </div>
            </div>
            {% endif %}
        </div>
        <div class="parallax"><img src="{{ asset('bundles/core/img/background/pic1.jpg') }}"></div>
    </div>
    <div class="container container_custom">
        <div class="row">

        {% for article in articles %}
            {% set i = i + 1 %}

            <div class="col s12 m6 l6 card">
                <div class="card-image waves-effect waves-block waves-light">
                    <img class="activator" src="{{ asset('bundles/core/img/background/pic3.jpg') }}">
                </div>
                <div class="card-content">
                    <span class="card-title activator grey-text text-darken-4">{{ article.titre }}<i class="material-icons right">add</i></span>
                    <p><a href="#">{{ article.date|date("d/m/Y") }}</a></p>
                    <div class="row">
                        <!-- Modal Trigger -->
                        {% if is_granted('ROLE_ADMIN') %}
                        <a class="col s4 offset-s1 waves-effect waves-light btn" href="#modal{{ article.id }}">Modifier</a>
                        {% endif %}

                        <!-- Modal Structure -->
                        <div id="modal{{ article.id }}" class="modal">
                            <!-- On rend la vue editArticle a la vue de la modal -->
                            {{ render(controller('BlogBundle:Actu:editArticle',{ 'id': article.id })) }}
                        </div>
                        <!-- Modal Trigger -->
                        {% if is_granted('ROLE_ADMIN') %}
                        <a class="col s4 offset-s2 waves-effect waves-light btn" href="{{ path('blog_actu_delete', { 'id': article.id }) }}">Effacer</a>
                        {% endif %}
                    </div>
                </div>
                <div class="card-reveal">
                    <span class="card-title grey-text text-darken-4">Card Title<i class="material-icons right">close</i></span>
                    <p>{{ article.contenu }}</p>
                </div>
            </div>
        {% if i is even %}
            </div> <!-- close row -->
        </div> <!-- close container -->
                    <div class="parallax-container">
                        <div class="parallax"><img src="{{ asset('bundles/core/img/background/pic3.jpg') }}"></div>
                    </div>
        <div class="container container_custom">
            <div class="row">
            {% endif %}
            {% endfor %}

    </div>



</div>
</div>

{% endblock %}